@inject CategoryHandlerService categoryHandler;

@using AdminApp.WASM.Models.FormModels;
@using AdminApp.WASM.Application.Utility;

<style>
	.hr-line {
		border: 1px solid black;
	}
</style>

<div class="">
	<div class="pb-2 row mx-0">
		<label class="form-label col-3 col-lg-2 col-form-label fs-5 fw-lighter">
			Назва
		</label>
		<div class="col-9 col-lg-6">
			<InputText @bind-Value="NewCandleForm.Name" class="form-control" />
			<ValidationMessage For="() => NewCandleForm.Name" />
		</div>
	</div>

	<div class="row pb-2 mx-auto">
		<label class="form-label col-3 col-lg-2 col-form-label fs-5 fw-lighter">
			Опис
		</label>
		<div class="col-9 col-lg-6">
			<InputText @bind-Value="NewCandleForm.Description" class="form-control" />
			<ValidationMessage For="() => NewCandleForm.Description" />
		</div>
	</div>

	<div class="pb-2 row">
		<label class="form-label col-4 col-lg-2 col-form-label fs-5 fw-lighter">
			Категорія
		</label>
		<div class="col-8 col-lg-6">
			<!-- display all categories as select list.
				also last should be "..." which means new category will be added
			-->
			<InputSelect @bind-Value="NewCandleForm.Category" class="form-select">
				@if (Categories.Any())
				{
					@foreach (var cat in Categories)
					{
						<option value="@cat">@cat</option>
					}
				}
			</InputSelect>
			<ValidationMessage For="() => NewCandleForm.Category" />
		</div>

		<!-- If user wants to add new category we use NewCategoryToAdd string field to save new cateogry name -->
		@if (NewCandleForm.Category == Constants.NEW_CATEGORY_TO_ADD_OPTION)
		{
			<label class="form-label col-5 col-lg-2 col-form-label fs-5 fw-lighter">
				Нова категорія
			</label>
			<div class="col-7 col-lg-6">
				<InputText @bind-Value="NewCategoryToAdd" class="form-control" @onfocusout="FocusOutFromNewCategoryInput" />
			</div>
		}
	</div>

	<hr class="hr-line" />

	<div class="container rounded border border-dark">

	<div class="pb-2 mt-2 mx-auto row input-group">
		<label class="form-label col-5 col-lg-2 col-form-label fw-lighter">
			Собівартість
		</label>
		<div class="col-3 col-lg-1">
			<InputNumber @bind-Value="NewCandleForm.RealCost" class="form-control text-center" step="1"/>
		</div>
		<label class="col-1 col-form-label-sm px-0 fw-lighter">
			грн.
		</label>
		<ValidationMessage For="() => NewCandleForm.RealCost" />
	</div>

	<div class="pb-2 mx-auto row input-group">
		<label class="form-label col-5 col-lg-2 col-form-label pe-0 me-0 fw-lighter">
			Ціна продажу
		</label>
		<div class="col-3 col-lg-1">
			<InputNumber @bind-Value="NewCandleForm.SellPrice" class="form-control text-center" />
		</div>
		<label class="col-1 col-form-label-sm px-0 fw-lighter">
			грн.
		</label>
		<ValidationMessage For="() => NewCandleForm.SellPrice" />
	</div>

</div>

	<hr class="hr-line" />
@* 
	<div class="pb-2 row input-group">
		<label class="form-label col-5 col-lg-2 col-form-label fw-lighter">
			Час горіння
		</label>
		<div class="col-3 col-lg-1">
			<InputNumber @bind-Value="NewCandleForm.BurningTimeMins" class="form-control text-center" />
		</div>
		<label class="col-1 col-form-label-sm px-0 fw-lighter">
			хв.
		</label>
		<ValidationMessage For="() => NewCandleForm.BurningTimeMins" />
	</div>

	<div class="pb-2 row input-group">
		<label class="form-label col-5 col-lg-2 col-form-label fw-lighter">
			Висота
		</label>
		<div class="col-3 col-lg-1">
			<InputNumber @bind-Value="NewCandleForm.HeightCM" class="form-control text-center" />
		</div>
		<label class="col-1 col-form-label-sm px-0 fw-lighter">
			см.
		</label>
		<ValidationMessage For="() => NewCandleForm.HeightCM" />
	</div>

	<div class="pb-2 row input-group">
		<label class="form-label col-5 col-lg-2 col-form-label fw-lighter">
			Гніт діаметр
		</label>
		<div class="col-3 col-lg-1">
			<InputNumber @bind-Value="NewCandleForm.WickDiameterCM" class="form-control text-center" />
		</div>
		<div class="col-1 px-0">
			<label class="col-1 col-form-label-sm px-0 mx-0 fw-lighter">
				ниток
			</label>
		</div>
		<ValidationMessage For="() => NewCandleForm.WickDiameterCM" />
	</div>

	<div class="pb-2 row input-group">
		<label class="form-label col-5 col-lg-2 col-form-label pe-0 fw-lighter">
			Воску потрібно
		</label>
		<div class="col-3 col-lg-1">
			<InputNumber @bind-Value="NewCandleForm.WaxNeededGram" class="form-control text-center" />
		</div>
		<label class="col-1 col-form-label-sm px-0 fw-lighter">
			г.
		</label>
		<ValidationMessage For="() => NewCandleForm.WaxNeededGram" />

	</div>

 *@


 <div class="container rounded border border-dark">

	<div class="pb-0 mt-2 mx-auto row input-group ubuntu" style="font-size: 14px; font-weight: bold;">
		<div class="col-6 ps-0">
			<label class="form-label mb-0"> Час горіння </label>
		</div>
		<div class="col-6 ps-0">
			<label class="form-label mb-0"> Висота </label>
		</div>
	</div>

	<div class="pb-2 mx-auto row input-group ubuntu">
			
		<InputNumber @bind-Value="NewCandleForm.BurningTimeMins" class="form-control text-center" />
		<span class="input-group-text col-2" style="font-size: 14px;">
			хв.
		</span>
			
		<InputNumber @bind-Value="NewCandleForm.HeightCM" class="form-control text-center" />
		<span class="input-group-text col-2" style="font-size: 14px;">
			см.
		</span>
	</div>

	<div class="pb-0 mx-auto row input-group ubuntu" style="font-size: 14px; font-weight: bold;">
		<div class="col-6 ps-0">
			<label class="form-label mb-0"> Діаметр гноту </label>
		</div>
		<div class="col-6 ps-0">
			<label class="form-label mb-0"> Воску треба </label>
		</div>
	</div>

	<div class="pb-2 mx-auto row input-group ubuntu" >

		<InputNumber @bind-Value="NewCandleForm.WickDiameterCM" class="form-control text-center" />
		<span class="input-group-text col-2 ps-1" style="font-size: 14px;">
			ниток
		</span>

		<InputNumber @bind-Value="NewCandleForm.WaxNeededGram" class="form-control text-center" />
		<span class="input-group-text col-2" style="font-size: 14px;">
			грам
		</span>
	</div>
 </div>


</div>

@code {

	[CascadingParameter]
	public NewCandleFormModel NewCandleForm { get; set; } = null!;

	[Parameter]
	public List<string> Categories { get; set; } = null!;


	// Possible new category to add
	[Parameter]
	public string NewCategoryToAdd { get; set; } = null!;

	[Parameter]
	public EventCallback<string> NewCategoryToAddChanged { get; set; }

	protected override void OnParametersSet()
	{
		NewCandleForm.Category = Categories.FirstOrDefault() ?? Constants.NEW_CATEGORY_TO_ADD_OPTION;
	}
	// On Focus Out from NewCategoryToAdd input field we notify the Parent that string has changed so the parent knows the string
	public void FocusOutFromNewCategoryInput()
	{
		NewCategoryToAddChanged.InvokeAsync(NewCategoryToAdd);
	}


	// api/CandleCategory
	// api/CandleCategory/{id}
	// api/CandleCategory - post
	// api/CandleCateogry/{id} - delete
	// api CandleCategory/{id} - edit

}
